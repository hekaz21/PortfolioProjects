--Cleaning Data in SQL Queries
select *
from [Nashville Housing].dbo.NashvilleHousing

--Standarize Date Format

select SaleDateConverted, convert(date,saledate)
from [Nashville Housing].dbo.NashvilleHousing

update NashvilleHousing
set SaleDate = CONVERT(date,saledate)

alter table NashvilleHousing 
add SaleDateConverted date;

update NashvilleHousing
set SaleDateConverted = CONVERT(date,saledate)


--Populate Propert Address Data

select *
from [Nashville Housing].dbo.NashvilleHousing
--where PropertyAddress is null
order by ParcelID


select a.ParcelID, a.PropertyAddress, b.ParcelID, b.PropertyAddress, isnull(a.PropertyAddress, b.PropertyAddress)
from [Nashville Housing].dbo.NashvilleHousing a
join [Nashville Housing].dbo.NashvilleHousing b
	on a.ParcelID = b.ParcelID
	and a.[UniqueID ] <> b.[UniqueID ]
where a.PropertyAddress is null

Update a
set PropertyAddress = isnull(a.PropertyAddress, b.PropertyAddress)
from [Nashville Housing].dbo.NashvilleHousing a
join [Nashville Housing].dbo.NashvilleHousing b
	on a.ParcelID = b.ParcelID
	and a.[UniqueID ] <> b.[UniqueID ]
where a.PropertyAddress is null




--Breaking out Address Into Individual Columns (address,City,State)


select PropertyAddress
from [Nashville Housing].dbo.NashvilleHousing
--where PropertyAddress is null
--order by ParcelID


select
SUBSTRING(propertyaddress, 1, CHARINDEX(',',PropertyAddress)-1) as Address,
SUBSTRING(propertyaddress, CHARINDEX(',',PropertyAddress)+1, len(propertyaddress)) as Address

from [Nashville Housing].dbo.NashvilleHousing

alter table NashvilleHousing 
add PropertySplitAddress nvarchar(255);

update NashvilleHousing
set PropertySplitAddress = SUBSTRING(propertyaddress, 1, CHARINDEX(',',PropertyAddress)-1)

alter table NashvilleHousing 
add PropertySplitCity nvarchar(255);

update NashvilleHousing
set PropertySplitCity = SUBSTRING(propertyaddress, CHARINDEX(',',PropertyAddress)+1, len(propertyaddress))


select *
from [Nashville Housing].dbo.NashvilleHousing
